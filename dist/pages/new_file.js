"use strict";var _createClass=function(){function i(t,s){for(var e=0;e<s.length;e++){var i=s[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(t,s,e){return s&&i(t.prototype,s),e&&i(t,e),t}}();function _classCallCheck(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}var Car=function(){function s(t){_classCallCheck(this,s),this.url=t.url,this.obox=t.obox,this.getCookie(),this.load()}return _createClass(s,[{key:"getCookie",value:function(){this.goods=JSON.parse($.cookie("goods")),console.log(this.goods)}},{key:"load",value:function(){var s=this;$.ajax({url:this.url,success:function(t){s.res=t,s.display()}})}},{key:"display",value:function(){var s=this,o="";$.each(this.res,function(t,i){$.each(s.goods,function(t,s){if(i.id==s.id){var e=parseInt(s.num)*parseInt(i.price.slice(0,i.price.length-1));o+='\n      \t\t\t\t\t   <li class="main-goods-list-item">\n\t\t\t\t\t\t\t\t<div class="list-select">\n\t\t\t\t\t\t\t\t<i class="daguo"></i>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="list-img"><img src="'+i.src+'"></div>\n\t\t\t\t\t\t\t\t<div class="list-name">'+i.describe+'</div>\n\t\t\t\t\t\t\t\t<div class="list-price">'+i.price+'</div>\n\t\t\t\t\t\t\t\t<div class="list-num">\n\t\t\t\t\t\t\t\t\t<b class="reduce"></b><input class="num-value" type="text" value="'+s.num+'"><b class="add"></b>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="list-tatol">'+e+'元</div>\n\t\t\t\t\t\t\t\t<div class="list-action" index="'+s.id+'">\n\t\t\t\t\t\t\t\t\t<span class="delete">X</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</li>\n      \t\t\t\t\t'}})}),this.obox.html(o),this.calculate(),this.click(),this.del(),this.getgoodsnum(),this.sel(),this.selAll(),this.tixing()}},{key:"listtatol",value:function(t,s){$(".list-tatol").eq(t).html(s*parseInt($(".list-price").eq(t).html().slice(0,$(".list-price").eq(t).html().length-1))+"元")}},{key:"calculate",value:function(){var e=0;$.each($(".list-select .daguo"),function(t,s){e+=Number($(s).parent().siblings(".list-tatol").html())}),$(".bottom-tatol span").html(e)}},{key:"click",value:function(){var i=this;$.each($(".add"),function(t,s){$(s).on("click",function(){var s=parseInt($(".num-value").eq(t).val());s++,$(".num-value").eq(t).val(s),i.listtatol(t,s),i.calculate(),i.id=$("list-action").eq(t).attr("index"),i.setCookie(function(t){i.goods[t].num=s}),i.getgoodsnum()})}),$.each($(".reduce"),function(t,s){$(s).on("click",function(){var s=parseInt($(".num-value").eq(t).val());--s<=1&&(s=1),$(".num-value").eq(t).val(s),i.listtatol(t,s),i.calculate(),i.id=$(".list-action").eq(t).attr("index"),i.setCookie(function(t){i.goods[t].num=s}),i.getgoodsnum()})}),$.each($(".num-value"),function(e,t){$(t).on("input",function(){var t=$(this).val();if(t){var s=parseInt(t);i.listtatol(e,s),i.calculate(),i.id=$("list-action").eq(e).attr("index"),i.setCookie(function(t){i.goods[t].num=s})}i.getgoodsnum()})})}},{key:"del",value:function(){var s=this;this.obox.on("click","span",function(){$(this).parent().parent().remove(),s.id=$(this).parent().attr("index"),s.setCookie(function(t){s.goods.splice(t,1)}),s.calculate(),s.getgoodsnum()})}},{key:"setCookie",value:function(t){for(var s=0;s<this.goods.length;s++)if(this.goods[s].id==this.id){t(s);break}$.cookie("goods",JSON.stringify(this.goods))}},{key:"getgoodsnum",value:function(){var e=0,i=0;$.each($(".list-select .daguo"),function(t,s){e+=parseInt($(s).parent().siblings(".list-num").children(".num-value").val())}),$.each($(".num-value"),function(t,s){i+=parseInt($(s).val())}),$(".bottom-left em").html(i),$(".bottom-left i").html(e)}},{key:"sel",value:function(){var e=this;$.each($(".list-select i"),function(t,s){$(s).on("click",function(){$(this).hasClass("daguo")?$(this).removeClass("daguo"):$(this).addClass("daguo"),e.calculate(),e.getgoodsnum(),e.tixing(),$(".list-select").find(".daguo").length!=$(".main-goods-list-item").length&&$(".top-select i").removeClass("daguo")})})}},{key:"selAll",value:function(){var e=this;$(".top-select i").on("click",function(){$(this).hasClass("daguo")?($(this).removeClass("daguo"),$.each($(".list-select i"),function(t,s){$(s).removeClass("daguo"),e.calculate(),e.getgoodsnum()})):($(this).addClass("daguo"),$.each($(".list-select i"),function(t,s){$(s).addClass("daguo"),e.calculate(),e.getgoodsnum()})),e.tixing()})}},{key:"tixing",value:function(){0==$(".list-select").find(".daguo").length?($(".jiesuan").css("display","block"),$(".bottom-pay").css({backgroundColor:"#E0E0E0",color:"#b0b0b0"}),$(".top-select i").removeClass("daguo")):($(".jiesuan").css("display","none"),$(".bottom-pay").css({backgroundColor:"#FF7600",color:"#FFFFFF"}),$(".top-select i").addClass("daguo"))}}]),s}();new Car({url:"https://localhost:8848/ajax/goodslist.json",obox:$(".main-go")});